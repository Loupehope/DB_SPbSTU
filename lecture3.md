# 1 Лекция
- [1 часть](https://github.com/Loupehope/DB_SPbSTU/blob/master/lecture.md#%D0%BF%D0%B5%D1%80%D0%B2%D0%B0%D1%8F-%D0%BB%D0%B5%D0%BA%D1%86%D0%B8%D1%8F)
- [2 часть](https://github.com/Loupehope/DB_SPbSTU/blob/master/lecture.md#%D0%B2%D1%82%D0%BE%D1%80%D0%B0%D1%8F-%D0%BB%D0%B5%D0%BA%D1%86%D0%B8%D1%8F)

# 2 Лекция
Кумулятивные статистики - суммарные данные о количестве и производительности событий, которые прошли в БД с момента старта экземпляра:
- события ожидания (wait events) - инфа о сессиях, которые были вынуждены ожидать или в данный момент ожидают по различным причинам
- временная модель - набор статистик, которые представляют процент от времени БД для каждого типа событий

Метрики: кол-во произошедших в единицу времени событий (транзакция, секунда)

Выборочные статистики - хранятся после перезапуска экземпляра - на сессию, на SQL, службы

Цели настройки:
- Minimising response time
- Increasing throughput
- Increasing load capabilities
- Decreasing recovery time

DB Time - количество времени в миллисекундах, затраченное БД на выполнение пользовательских запросов (не включаются фоновые запросы, не простаивающие пользовательские сессии). Изменяется суммарно с момента запуска экземпляра.

Free buffer waits - время ожидания свободных буфферов в ОЗУ (DBWR), чтобы серверный процесс мог туда записать новый блок из файловой системы.

Buffer busy waits - сессия хочет получить доступ к блоку базы данных Buffer Cache (DBWR) - но не может, тк буффер занят сейчас - кто-то его уже изменяет

enq: TX - index contention - ожидание, связанное с работой индекса - ТХ - блокировка таблицы на уровне строк 

Log file sync - ожидание, связанна с Log Writer - перегружен и не успевает всё записать redo log файлы 

db file sequential read - ожидание, связанное с чтением данных из файла - серверный процесс пытается читать информацию из файла, но I/O слишком медленный

DB Time = DB wait time (нужна настройка экземпляра) + DB CPU time (нужна настройка SQL команд)

Time Model:
- V$SYS_TIME_MODEL
- V$SESS_TIME_MODEL

Динамические представления - предоставляют информацию об изменении состояния и условий в экземпляре (Доступ Sys, select_catalog_row) (ОЗУ)

Уровни статистики V&STATISTICS_LEVEL:
- Basic - автоматически статистики не собираются
- Typical - данные для статистики собираются на уровне сегментов
- All - дом статистики собираются из ОС

Системные статистики:
- V$STATNAME - названия статистик
- V$SYSSTAT - для SYS
- V$SESSTAT - статистики для всех сессий
- V$MYSTAT - статистики для текущей сессии
- V$SERVICESTAT - для служб

Классы ожиданий:
- V$SESSION_WAIT_CLASS
- V$SYSTEM_WAIT_CLASS
- V$SERVICE_WAIT_CLASS
- V$EVENT_NAME

- V$SESSION_WAIT - события и ресурсы, которые ожидает сессия
